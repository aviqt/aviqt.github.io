(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{466:function(e,t,n){var content=n(467);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(23).default)("31ac193a",content,!0,{sourceMap:!1})},467:function(e,t,n){var o=n(22)(!1);o.push([e.i,'html{font-size:20px}body{background:#ececec;position:relative;overflow:hidden}#__layout>div,#__layout>div>div{position:relative;height:100%}.top-button-box{position:fixed;top:.3rem;left:.5rem;z-index:5}.warpper{position:fixed;top:0;bottom:0;left:0;right:0;background:rgba(41,77,255,.9);z-index:6}.warpper>span{display:block;font-size:2rem;left:50%;transform:translate(-50%,-50%)}.warpper>span,.warpper>strong{position:absolute;font-weight:700;color:#fff;text-align:center;line-height:1.3;top:50%}.warpper>strong{font-size:5rem;width:100%;left:0;transform:translateY(-50%)}.pad-login-box{width:30rem;text-align:center;position:fixed;height:22rem;left:50%;top:50%;margin:-12rem 0 0 -14rem}.pad-login-box .title{color:#fff;font-size:2.5rem;font-weight:700}.pad-login-box .select-role{margin-top:3rem}.pad-login-box .select-role div{background:#fff;color:#4177ff;text-align:center;font-weight:700;border-radius:.3rem;line-height:3rem;font-size:1.2rem;width:50%;margin:0 auto 2rem}.pad-login-box .select-role div:active{background:#eee}.pad-login-inner{width:70%;margin:3rem auto 0}.pad-login-inner .role-title{color:#fff;text-align:center;font-size:1.5rem;line-height:2rem;font-weight:700;position:relative}.pad-login-inner .role-title:before{left:1rem}.pad-login-inner .role-title:after,.pad-login-inner .role-title:before{content:"";position:absolute;width:10%;height:.1rem;background:#fff;top:50%}.pad-login-inner .role-title:after{right:1rem}.pad-login-form{background:#fff;border-radius:.3rem;padding:1.2rem 2rem 1rem;margin-top:1.5rem}.pad-login-form .form-item{padding-bottom:1rem;padding-left:2.5rem;position:relative}.pad-login-form .form-item .iconfont{position:absolute;top:.4rem;left:.1rem;font-size:1.5rem;color:#4177ff}.pad-login-form .el-input__inner{outline:none;border-radius:0;border:none;border-bottom:.1rem solid #a7c0fe;color:#4177ff;font-size:1rem;height:2rem}.pad-login-form .button{background:#3e75fa;text-align:center;line-height:2rem;border-radius:1rem;color:#fff;cursor:pointer}.pad-login-form .button:hover{background:#5c94fb}.exam-box{background:#fff;position:absolute;left:1rem;right:1rem;top:1rem;bottom:1rem;overflow:auto;padding:0 2rem;text-align:center}.exam-box .lab-info{overflow:hidden;line-height:3rem;text-align:center;font-size:1.1rem;font-weight:700}.exam-box .table-info{margin-top:1.2rem;padding:0 .5rem}.exam-box .table-info span{margin-bottom:1rem;font-size:2.2rem;text-align:center;line-height:2.6rem;font-weight:700;display:block}.examinee-info{position:relative;overflow:hidden;padding:1rem 0;display:inline-block;text-align:left}.examinee-info>div{display:table-cell;height:16rem;vertical-align:middle}.examinee-info img{float:left;height:16rem;margin-right:2rem;display:block}.examinee-info span{display:block;font-weight:700;font-size:1.8rem;line-height:5rem}.pad-testing .exam-box .lab-info,.pad-testing .exam-box .table-info,.pad-testing .examinee-info{display:none}.pad-testing .examinee-info>div{height:6rem}.pad-testing .examinee-info img{width:4.5rem;height:6rem;margin-right:1rem}.pad-testing .examinee-info span{font-size:.9rem;line-height:1.8rem}.before-exam span{font-size:3rem;font-weight:700;line-height:5rem}.lamp{position:absolute;top:2.8rem;right:1rem;height:1rem;width:1rem;background:#f56c6c;border-radius:50%;box-shadow:inset 0 -1px 5px #fff;z-index:9999}.green-light{background:#67c23a}.pad-top{display:none;padding:.5rem 0;line-height:1.2rem;background:#4177ff;z-index:5;position:relative}.pad-top span{color:#fff;font-size:.9rem;display:table-cell;text-align:center;vertical-align:middle;padding:0 .3rem}.pad-title{line-height:2.2rem;background:#fff;font-size:1.2rem;text-align:center;font-weight:700;box-shadow:0 0 .3rem grey;z-index:5;position:relative}.logout-btn{position:absolute;top:0;right:2.2rem;font-size:1rem;font-weight:400;color:#4177ff;padding:0 .5rem;cursor:pointer}.logout-btn:active{color:#3066ee;background:#efefef}.back-btn{position:absolute;top:0;left:0;font-size:2rem;font-weight:400;padding:0 .6rem}.back-btn .iconfont{font-size:inherit}.back-btn:active{color:#3066ee;background:#efefef}.pad-main{position:absolute;top:4.2rem;left:0;bottom:0;right:0}.pad-testing .pad-top{display:table;width:100%}.pad-testing .pad-main{top:5rem}.pad-operation-menu{//text-align:center;margin:1.5rem 0 1rem}.pad-operation-menu .pad-button{display:inline-block;background:#4177ff;color:#fff;font-weight:700;padding:.5rem 5rem;border-radius:.3rem;font-size:1.2rem}.pad-operation-menu .pad-button:active{opacity:.8}@media screen and (min-width:1920px){html{font-size:30px}}@media screen and (max-width:1920px){html{font-size:28px}}@media screen and (max-width:1600px){html{font-size:25px}}@media screen and (max-width:1440px){html{font-size:24px}}@media screen and (max-width:1280px){html{font-size:22px}}@media screen and (max-width:1024px){html{font-size:18px}}@media screen and (max-width:800px){html{font-size:14px}}@media screen and (max-width:600px){html{font-size:12px}}@media screen and (max-width:500px){html{font-size:10px}}',""]),e.exports=o},481:function(e,t,n){e.exports=n.p+"img/before-exam.8ba48d2.png"},505:function(e,t,n){e.exports=n.p+"img/examinee.053bfcd.png"},529:function(e,t,n){var content=n(592);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(23).default)("1ce6f022",content,!0,{sourceMap:!1})},591:function(e,t,n){"use strict";n(529)},592:function(e,t,n){var o=n(22)(!1);o.push([e.i,".pad-top span[data-v-c2c3411e]{width:33.3%}",""]),e.exports=o},654:function(e,t,n){"use strict";n.r(t);n(58),n(31),n(43),n(71),n(72);var o=n(25),r=(n(37),n(466),n(471)),d={data:function(){return{ws:{obj:null,url:"ws://t.expexam.final.joyread.com.cn",lockReconnect:!1,tt:null,linkState:0},heartCheck:{timeout:3e3,timeoutObj:null,serverTimeoutObj:null,start:this.heartCheckStart},hearting:!1}},mounted:function(){this.heartCheck.start(),window.location.host.indexOf("localhost"),this.ws.url=(6===window.location.protocol.length?"wss://":"ws://")+window.location.host},destroyed:function(){this.ws.tt&&clearTimeout(this.ws.tt),this.heartCheck.timeoutObj&&clearTimeout(this.heartCheck.timeoutObj),this.heartCheck.serverTimeoutObj&&clearTimeout(this.heartCheck.serverTimeoutObj)},methods:{heartCheckStart:function(){var e=this;e.heartCheck.timeoutObj&&clearTimeout(e.heartCheck.timeoutObj),e.heartCheck.serverTimeoutObj&&clearTimeout(e.heartCheck.serverTimeoutObj),e.heartCheck.timeoutObj=setTimeout((function(){console.log("Heart beat");try{e.ws.obj&&e.ws.obj.send&&e.ws.obj.send("ping")}catch(e){console.log(e)}e.heartCheck.serverTimeoutObj=setTimeout((function(){0==e.ws.linkState&&e.reconnectWs(),e.heartCheck.start()}),e.heartCheck.timeout)}),e.heartCheck.timeout)},reconnectWs:function(){var e=this;e.ws.lockReconnect||(e.ws.lockReconnect=!0,e.ws.tt&&clearTimeout(e.ws.tt),e.ws.tt=setTimeout((function(){console.log("Reconnect ws"),e.ws.lockReconnect=!1,e.createWebSocket()}),8e3))},createWebSocket:function(){var e=this;try{e.ws.obj=new WebSocket(e.ws.url),e.initWebSocket()}catch(t){this.$message.error("catch error。"),e.reconnectWs()}},initWebSocket:function(){var e=this;e.ws.obj.onclose=function(){console.log("链接关闭"),e.ws.linkState=0},e.ws.obj.onerror=function(){e.ws.linkState=0},e.ws.obj.onopen=function(){e.ws.linkState=1,e.heartCheck.start()},e.ws.obj.onmessage=function(t){e.ws.linkState=1,e.ws.tt&&clearTimeout(e.ws.tt);var data="";try{"506"===(data=JSON.parse(t.data)).code||"510"===data.code||"508"===data.code?(e.handleWsDataSpec&&e.handleWsDataSpec(data),"506"===data.code&&(e.ws.lockReconnect=!0)):e.handleWsData&&e.handleWsData(data)}catch(n){data=t.data,e.debugMessage+=data+";  "}e.heartCheck.start()}}}},c=n(86);function l(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function m(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?l(Object(source),!0).forEach((function(t){Object(o.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):l(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var h={mixins:[r.a,d,c.a],data:function(){return{title:["实验未开始","准备实验","已签到","实验中","实验结束"],status:-1,paperId:1,seat:[],schedule:[],examPaper:[],data:[],paperFnObj:{confirmSP:this.confirmSubmitPaper,SP:this.submitPaper}}},mounted:function(){this.linkWs()},destroyed:function(){clearInterval(this.st)},methods:{linkWs:function(){var e=this;this.$store.dispatch("pad/IS_PAD_VALID",{params:{},cb:function(t){t.data?(e.ws.url+="/socket/student",e.createWebSocket()):e.$message.error("该设备还没有绑定座位")}})},startCountDown:function(){var e=this;clearInterval(this.countDown.timer),this.$store.dispatch("pad/GET_SERVER_CURRENTDATE",{data:{},cb:function(t){if(t.succ&&e.data.schedule){var n=t.data?t.data:(new Date).valueOf(),o=new Date(e.data.schedule.planDate+" "+e.data.schedule.end).valueOf();e.countDown.timeLimit=parseInt((o-n)/1e3),e.countDown.timer=setInterval((function(){e.countDown.timeLimit--,e.countDown.timeLimit=e.countDown.timeLimit>0?e.countDown.timeLimit:0,0===e.countDown.timeLimit&&e.$refs.exmPaper&&0!=e.data.doneTest&&(e.$refs.exmPaper.submitPaper&&e.$refs.exmPaper.submitPaper(),clearInterval(e.countDown.timer))}),1e3)}}})},handleWsData:function(data){"510"!==data.code?"100"===data.code&&(this.data=data||[],this.seat=data.seat?data.seat:[],this.schedule=data.schedule?data.schedule:[],this.examPaper=data.examPaper?data.examPaper:[],this.paperId=this.examPaper.id?this.examPaper.id:1,this.status=-1,this.status=this.examStatusList.indexOf(data.examStatus),4===this.status&&this.$refs.exmPaper&&0!=this.data.doneTest&&(this.$refs.exmPaper.submitPaper&&this.$refs.exmPaper.submitPaper(),clearInterval(this.countDown.timer)),3==this.status&&this.startCountDown()):this.seat=data.data?data.data:[]},handleImgError:function(e){e.target.src=n(505)},confirmSubmitPaper:function(e){this.confrimInfo={show:!0,isConfrim:!0,handlEvent:e,title:"提前交卷",text:"交卷后无法继续做题！是否确认要提前交卷？"}},submitPaper:function(data){var e=this;this.$store.dispatch("pad/SUBMIT_PAPER",{data:m(m({},data),{},{course:this.data.schedule.course,scheduleId:this.data.schedule.id,paperId:this.paperId}),cb:function(t){t.succ&&(e.$message.success("交卷成功。"),e.data.doneTest="0")}})}},computed:{startTime:function(){return this.data.schedule&&this.data.schedule.startStr?this.data.schedule.startStr.substr(0,5):"00:00"},endTime:function(){return this.data.schedule&&this.data.schedule.endStr?this.data.schedule.endStr.substr(0,5):"00:00"},studentNameStr:function(){return this.data.student?(this.data.student[0]?this.data.student[0].name:"")+(this.data.student[1]?" , "+this.data.student[1].name:""):""},studentCodeStr:function(){return this.data.student?(this.data.student[0]?this.data.student[0].code:"")+(this.data.student[1]?" , "+this.data.student[1].code:""):""}}},f=(n(591),n(10)),component=Object(f.a)(h,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{class:{"pad-testing":3===e.status}},[3===e.status?o("div",{staticClass:"pad-top"},[o("span",[e._v("实验室："+e._s(e.seat.roomName))]),e._v(" "),o("span",[e._v("剩余时间："+e._s(e.timeLimitM)+":"+e._s(e.timeLimitS))]),e._v(" "),o("span",[e._v("实验时间："+e._s(e.startTime)+"-"+e._s(e.endTime))])]):e._e(),e._v(" "),o("div",{staticClass:"pad-title"},[e._v("\n      "+e._s(e.status<0?"空闲中":e.title[e.status])+"\n      "),e._v(" "),o("div",{staticClass:"lamp",class:{"green-light":1===this.ws.linkState}})]),e._v(" "),o("div",{staticClass:"pad-main"},[o("div",{staticClass:"exam-box"},[o("div",{staticClass:"table-info"},[o("span",[e._v("实验室："+e._s(e.seat.roomName))]),e._v(" "),o("span",[e._v("座位号："+e._s(e.seat.code))])]),e._v(" "),e.status>0?o("div",{staticClass:"examinee-info"},[o("div",[3===e.status?o("span",[e._v("座位号："+e._s(e.seat.code))]):e._e(),e._v(" "),1===e.status?o("span",[e._v("实验时间："+e._s(e.schedule.planDateStr+" "+e.schedule.startStr))]):e._e(),e._v(" "),1===e.status?o("span",[e._v("实验名称："+e._s(e.examPaper.examName))]):e._e(),e._v(" "),o("span",[e._v("学生姓名："+e._s(e.studentNameStr))]),e._v(" "),o("span",[e._v("学生学号："+e._s(e.studentCodeStr))])])]):e._e(),e._v(" "),e.status<1?o("div",{staticClass:"before-exam"},[o("img",{attrs:{src:n(481)}}),o("br"),e._v(" "),o("span",[e._v(e._s(0===e.status?"实验未开始":"该位置空闲中"))])]):e._e(),e._v(" "),o("div"),e._v(" "),10===e.status?o("el-select",{attrs:{placeholder:"请选择"},model:{value:e.paperId,callback:function(t){e.paperId=t},expression:"paperId"}},e._l(e.paperList,(function(e){return o("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1):e._e(),e._v(" "),o(this.paperList.filter((function(t){return t.id===e.paperId}))[0].com,{directives:[{name:"show",rawName:"v-show",value:3===e.status,expression:"status === 3"}],ref:"exmPaper",tag:"component",attrs:{fnObj:e.paperFnObj}})],1)]),e._v(" "),"0"!==e.data.doneTest||3!==e.status&&4!==e.status?e._e():o("div",{staticClass:"warpper"},[o("span",[e._v("已交卷")])]),e._v(" "),o("el-confrim",{attrs:{confrimInfo:e.confrimInfo}})],1)}),[],!1,null,"c2c3411e",null);t.default=component.exports}}]);