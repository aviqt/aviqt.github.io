(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{478:function(e,t,n){var content=n(502);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(23).default)("daf89fd0",content,!0,{sourceMap:!1})},487:function(e,t){e.exports={NVRSERVER:{szIP:"192.168.1.200",szPort:"80",szUsername:"admin",szPassword:"123456Aa"},NVRTESTDATA:{iChannelID:"3",szStartTime:"2020-10-19 16:10:00",szEndTime:"2020-10-19 16:15:37"}}},501:function(e,t,n){"use strict";n(478)},502:function(e,t,n){var o=n(22)(!1);o.push([e.i,'.divPlugin-box[data-v-d585f110]{position:absolute;width:100%;top:0;bottom:75px}.fullScreen-box[data-v-d585f110]{position:fixed;left:0;top:0}.plugin[data-v-d585f110]{position:relative;height:100%;width:100%}.video-control-box[data-v-d585f110]{position:absolute;height:75px;width:100%;bottom:-75px;left:0;z-index:5;background:grey}.video-control-box>.iconfont[data-v-d585f110]{position:absolute;font-size:100px;margin:-50px 0 0 -50px;cursor:pointer;left:50%;top:50%;color:#fff;display:none}.video-control-box>.pause-area[data-v-d585f110]{position:absolute;height:100%;width:100%;cursor:pointer;left:0;top:0;background:transparent;display:none}.video-control-box:hover>.pause-area[data-v-d585f110]{display:block}.video-control-box .control-bar[data-v-d585f110]{position:absolute;height:70px;width:100%;bottom:0;left:0;background:rgba(0,0,0,.5);opacity:1;transition:all .2s;color:#fff}.video-control-box:hover .control-bar[data-v-d585f110]{opacity:1}.control-bar>i[data-v-d585f110]{position:absolute;font-size:40px;cursor:pointer}.control-bar .play-pause[data-v-d585f110]{left:15px;top:15px}.control-bar .full-screen[data-v-d585f110]{right:15px;top:15px}.control-bar .time-warp[data-v-d585f110]{position:absolute;left:70px;top:27px}.control-bar .progress-bar[data-v-d585f110]{height:15px;width:100%;cursor:pointer;position:relative;margin-top:-5px}.progress-bar .progress-bar-line[data-v-d585f110]{top:5px;height:5px;width:100%;padding-right:16px;background:#fff;background:hsla(0,0%,100%,.2);position:absolute}.progress-bar-line .progress-bar-inner[data-v-d585f110]{height:100%;background:#df953a;position:relative}.progress-bar-line .progress-bar-inner[data-v-d585f110]:before{content:"";height:16px;width:16px;left:100%;top:-6px;border-radius:50%;border:5px solid #fff;background:#df953a;position:absolute}.control-bar .speed-change[data-v-d585f110]{position:absolute;right:70px;top:16px;cursor:pointer;line-height:40px;min-width:130px;text-align:center}.control-bar .speed-change[data-v-d585f110]:hover{background:rgba(0,0,0,.5)}.speed-change .speed-list[data-v-d585f110]{position:absolute;right:100%;bottom:0;width:200px;background:rgba(0,0,0,.5);display:none}.control-bar .speed-change:hover .speed-list[data-v-d585f110]{display:block}.speed-change .speed-list span[data-v-d585f110]{display:inline-block;width:80px;text-align:center}.speed-change .speed-list span[data-v-d585f110]:hover{color:#ff8c00;background:hsla(0,0%,100%,.1)}',""]),e.exports=o},510:function(e,t,n){"use strict";var o=n(25),r=(n(266),n(13),n(60),n(61),n(57),n(58),n(31),n(43),n(71),n(72),n(85)),c=n(470),d=n.n(c),l=n(487),f=n.n(l);function m(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function h(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?m(Object(source),!0).forEach((function(t){Object(o.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):m(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var v={props:["WCdata"],mixins:[{data:function(){return{serverData:{szIP:"12.7.1.9",szPort:"443",szUsername:"admin",szPassword:"nb@kk0574"},szInfo:"",g_iWndIndex:0,playbackRate:1,videoData:{szDeviceIdentify:"12.7.1.9_443",iRtspPort:554,iStreamType:1,bZeroChannel:!1,iChannelID:"6",currentTime:"2020-04-08 09:07:15",szStartTime:"2020-04-08 09:07:15",szEndTime:"2020-04-08 09:17:59",bChecked:!1}}},mounted:function(){var e=this;console.log(f.a),this.serverData=f.a.NVRSERVER,this.videoData.szDeviceIdentify=this.serverData.szIP+"_"+this.serverData.szPort,setTimeout((function(){e.initPlugin()}),1e3),setInterval(this.GetOSDTime,500)},beforeDestroy:function(){},methods:{I_Resize:function(){WebVideoCtrl&&WebVideoCtrl.I_Resize(d()(".divPlugin-box").width(),d()(".divPlugin-box").height())},I_FullScreen:function(){WebVideoCtrl&&WebVideoCtrl.I_FullScreen(!0)},I_Pause:function(){WebVideoCtrl&&WebVideoCtrl.I_Pause({iWndIndex:this.g_iWndIndex})},I_Resume:function(){WebVideoCtrl&&WebVideoCtrl.I_Resume({iWndIndex:this.g_iWndIndex})},I_PlaySlow:function(){var e=this;WebVideoCtrl&&WebVideoCtrl.I_PlaySlow({success:function(){e.$message.success("慢放成功！"),e.playbackRate=e.playbackRate/2},error:function(){e.$message.error("慢放失败！")}})},I_PlayFast:function(){var e=this;WebVideoCtrl&&WebVideoCtrl.I_PlayFast({success:function(){e.$message.success("快放成功！"),e.playbackRate=2*e.playbackRate},error:function(){e.$message.error("快放失败！")}})},GetOSDTime:function(){var e=this;if(WebVideoCtrl&&null!=WebVideoCtrl.I_GetWindowStatus(this.g_iWndIndex))WebVideoCtrl.I_GetOSDTime({success:function(t){e.setVideoTimeData(t)},error:function(){}})},initPlugin:function(){var e=this;WebVideoCtrl&&WebVideoCtrl.I_InitPlugin("100%","100%",{bWndFull:!0,iPackageType:2,iWndowType:1,bNoPlugin:!0,cbSelWnd:function(t){var n="当前选择的窗口编号："+e.g_iWndIndex;e.showCBInfo(n),e.logout(),setTimeout((function(){e.login()}),150)},cbDoubleClickWnd:function(t,n){var o="当前放大的窗口编号："+t;n||(o="当前还原的窗口编号："+t),e.showCBInfo(o)},cbEvent:function(t,n,o){2==t?e.showCBInfo("窗口"+n+"回放结束！"):-1==t?e.showCBInfo("设备"+n+"网络错误！"):3001==t&&clickStopRecord(g_szRecordType,n)},cbRemoteConfig:function(){e.showCBInfo("关闭远程配置库！")},cbInitPluginComplete:function(){WebVideoCtrl.I_InsertOBJECTPlugin("divPlugin"),-1!=WebVideoCtrl.I_CheckPluginVersion()||alert("检测到新的插件版本，双击开发包目录里的WebComponentsKit.exe升级！")}}),d()(window).bind({resize:function(){e.I_Resize()}})},logout:function(){var e=this.serverData,t=e.szIP,n=e.szPort;e.szUsername,e.szPassword;if(""!=t&&""!=n){var o=t+"_"+n;WebVideoCtrl&&WebVideoCtrl.I_Logout(o)}},login:function(){var e=this,t=this.serverData,n=t.szIP,o=t.szPort,r=t.szUsername,c=t.szPassword;if(""!=n&&""!=o){var d=n+"_"+o;-1==WebVideoCtrl.I_Login(n,1,o,r,c,{success:function(t){e.showCBInfo(d+" 登录成功！")},error:function(t,n){e.showCBInfo(d+" 登录失败！",t,n),e.$message.error("登录失败！")}})&&this.showCBInfo(d+" 已登录过！")}},preSPB:function(){var e=this;null!=WebVideoCtrl.I_GetWindowStatus(this.g_iWndIndex)?WebVideoCtrl.I_Stop({success:function(){e.startPlayback()}}):this.startPlayback()},startPlayback:function(){var e=this,t=this.videoData,n=t.szDeviceIdentify,o=t.iRtspPort,r=t.iStreamType,c=t.bZeroChannel,d=t.iChannelID,l=t.szStartTime,f=t.szEndTime,m=t.bChecked,h=t.szInfo;if(l=this.videoData.currentTime,null!=n&&!c)if(m){WebVideoCtrl.I_StartPlayback(n,{iRtspPort:o,iStreamType:r,iChannelID:d,szStartTime:l,szEndTime:f,oTransCodeParam:{TransFrameRate:"14",TransResolution:"1",TransBitrate:"19"},success:function(){e.initData(),h="开始回放成功！",e.showCBInfo(n+" "+h)},error:function(t,o){403===t?h="设备不支持Websocket取流！":(h="开始回放失败！",e.$message.error(h)),e.showCBInfo(n+" "+h)}})}else WebVideoCtrl.I_StartPlayback(n,{iRtspPort:o,iStreamType:r,iChannelID:d,szStartTime:l,szEndTime:f,success:function(){e.initData(),h="开始回放成功！",e.showCBInfo(n+" "+h)},error:function(t,o){403===t?h="设备不支持Websocket取流！":(h="开始回放失败！",e.$message.error(h)),e.showCBInfo(n+" "+h)}})},showCBInfo:function(e){this.szInfo=this.szInfo+r.a.dateFtt("yyyy-MM-dd hh:mm:ss  ",new Date)+e+" ---- "}},head:function(){return{script:[{src:"../../../jquery-1.12.4.min.js"},{src:"../../../codebase/encryption/AES.js"},{src:"../../../codebase/encryption/cryptico.min.js"},{src:"../../../codebase/encryption/crypto-3.1.2.min.js"},{src:"../../../codebase/webVideoCtrl.js"}]}}}],components:{},data:function(){return{video:{active:!1,paused:!1,currentTime:""},videoProps:{currentTime:"",duration:""},isFullScreen:!1,mouseOverBTime:""}},mounted:function(){},methods:{_changeSpeed:function(e){if("减速"===e){if(.25===this.playbackRate)return;this.I_PlaySlow()}else{if(8===this.playbackRate)return;this.I_PlayFast()}},_fullScreen:function(e){var t=this,n=document.getElementById("divPlugin-box");document.fullScreen||document.mozFullScreen||document.webkitIsFullScreen?document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen():n.requestFullscreen&&n.requestFullscreen()||n.mozRequestFullScreen&&n.mozRequestFullScreen()||n.webkitRequestFullscreen&&n.webkitRequestFullscreen()||n.msRequestFullscreen&&n.msRequestFullscreen(),setTimeout((function(){t.I_Resize()}),200)},_play:function(){this.video.paused?this.I_Resume():this.I_Pause(),this.video.paused=!this.video.paused},_MMProgressBar:function(e){this.mouseOverBTime="";var t=this.$refs.progressBar,n=(e.clientX-this.elementPageX(t))/t.offsetWidth*this.videoProps.duration;this.mouseOverBTime=parseInt(n/60).toString().padStart(2,"00")+":"+parseInt(n%60).toString().padStart(2,"00")},_clickProgressBar:function(e){var t=this.$refs.progressBar,n=(e.clientX-this.elementPageX(t))/t.offsetWidth*this.videoProps.duration;n=new Date(this.videoData.szStartTime.replace(/\-/g,"/")).getTime()+1e3*n,this.videoData.currentTime=r.a.dateFtt("yyyy-MM-dd hh:mm:ss",new Date(n)),this.video.paused=!1,this.preSPB()},elementPageX:function(e){return e.offsetParent?e.offsetLeft+this.elementPageX(e.offsetParent):e.offsetLeft},setVideoTimeData:function(time){this.video.currentTime=time;var e=new Date(this.video.currentTime.replace(/\-/g,"/")).getTime()/1e3,t=new Date(this.videoData.szStartTime.replace(/\-/g,"/")).getTime()/1e3,n=new Date(this.videoData.szEndTime.replace(/\-/g,"/")).getTime()/1e3;this.videoProps.currentTime=e-t,this.videoProps.duration=n-t},preSPB_start:function(){this.videoData=Object.assign({},this.videoData,this.WCdata),this.videoData.currentTime=this.videoData.szStartTime,this.preSPB()},initData:function(){this.playbackRate=1,this.video=h(h({},this.video),{},{active:!0,paused:!1})}},computed:{progressBarInnerWidth:function(){return 0===this.videoProps.duration?0:this.videoProps.currentTime/this.videoProps.duration*100+"%"},computedVideoProps:function(){var e=this.videoProps.currentTime>0?this.videoProps.currentTime:0,t=this.videoProps.duration;return{currentTime:e=parseInt(e/60).toString().padStart(2,"00")+":"+parseInt(e%60).toString().padStart(2,"00"),duration:t=parseInt(t/60).toString().padStart(2,"00")+":"+parseInt(t%60).toString().padStart(2,"00")}}}},x=(n(501),n(10)),component=Object(x.a)(v,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"divPlugin-box",class:{"fullScreen-box":e.isFullScreen},attrs:{id:"divPlugin-box"}},[n("div",{staticClass:"plugin",attrs:{id:"divPlugin"}}),e._v(" "),e.video.active?n("div",{staticClass:"video-control-box"},[n("div",{staticClass:"pause-area",on:{click:e._play}}),e._v(" "),e.video.paused?n("i",{staticClass:"iconfont icon-playcircle",on:{click:e._play}}):e._e(),e._v(" "),n("div",{staticClass:"control-bar"},[n("div",{ref:"progressBar",staticClass:"progress-bar",attrs:{title:e.mouseOverBTime},on:{mousemove:e._MMProgressBar,click:e._clickProgressBar}},[n("div",{staticClass:"progress-bar-line"},[n("div",{staticClass:"progress-bar-inner",style:{width:e.progressBarInnerWidth}})])]),e._v(" "),n("i",{staticClass:"iconfont  play-pause",class:{"icon-playcircle":e.video.paused,"icon-pause":!e.video.paused},on:{click:e._play}}),e._v(" "),n("i",{staticClass:"el-icon-full-screen full-screen",on:{click:e._fullScreen}}),e._v(" "),n("span",{staticClass:"time-warp"},[e._v(e._s(e.computedVideoProps.currentTime)+" / "+e._s(e.computedVideoProps.duration))]),e._v(" "),n("div",{staticClass:"speed-change"},[e._v("\n          播放速度 x"+e._s(e.playbackRate)+"\n          "),n("div",{staticClass:"speed-list"},e._l(["减速","加速"],(function(t){return n("span",{key:t,style:{color:t===e.playbackRate?"orange":""},on:{click:function(n){return e._changeSpeed(t)}}},[e._v(e._s(t))])})),0)])])]):e._e()])}),[],!1,null,"d585f110",null);t.a=component.exports},553:function(e,t,n){var content=n(641);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(23).default)("1addf81e",content,!0,{sourceMap:!1})},640:function(e,t,n){"use strict";n(553)},641:function(e,t,n){var o=n(22)(!1);o.push([e.i,".download-btn[data-v-13defdef]{cursor:pointer;color:#4177ff;text-decoration:underline;display:block;position:absolute;top:50px;left:20px;font-size:16px;font-weight:400}.download-btn[data-v-13defdef]:hover{color:orange}.playWnd[data-v-13defdef]{background:#fff;width:100%;height:100%}body[data-v-13defdef]{background-size:cover}.top-userInfo[data-v-13defdef]{background:#000;color:#fff}.top-userInfo>strong[data-v-13defdef]{font-size:18px;float:left;margin-left:20px;display:inline-block}.top-userInfo .button[data-v-13defdef]:hover{background:#666}.container[data-v-13defdef]{top:70px;left:20px}.container[data-v-13defdef],.container .box[data-v-13defdef]{position:absolute;right:0;bottom:0}.container .box[data-v-13defdef]{top:0;left:0;margin-right:20px;margin-bottom:20px}.container .box[data-v-13defdef]:first-child{right:30%}.container .box[data-v-13defdef]:nth-child(2){left:70%}.box-head[data-v-13defdef]{border-left:5px solid #4177ff;line-height:24px;padding-left:8px;font-size:20px;font-weight:700}.box-head .camera-list[data-v-13defdef]{position:absolute;left:100px;top:0}.box-head a[data-v-13defdef]{color:#4177ff;margin-left:50px;font-size:16px;text-decoration:none;font-weight:400}.box-head a[data-v-13defdef]:hover{text-decoration:underline}.camera-list span[data-v-13defdef]{font-size:16px;cursor:pointer;padding:0 10px}.camera-list .selected[data-v-13defdef]{color:#4177ff;font-weight:700}.box-body[data-v-13defdef]{position:absolute;left:0;bottom:0;right:0;top:35px;background:#fff}.point-top[data-v-13defdef]{position:absolute;width:80px;right:30px;top:-30px;line-height:30px;text-align:right;display:table}.point-top span[data-v-13defdef]{display:table-cell;width:80px;text-align:center}.focus[data-v-13defdef]{color:#4177ff}",""]),e.exports=o},667:function(e,t,n){"use strict";n.r(t);var o=n(488),r=(n(57),n(59),n(43),n(470)),c=n.n(r),d=n(85),l=n(86),f=n(471),m=n(548),h=n(557),v=n(558),x=n(559),I=n(510),w=n(15),C=n.n(w),_={mixins:[l.a,m.a,f.a],components:{ImgView:h.a,ImgListView:x.a,AuthImgView:v.a,WebControl:I.a},data:function(){return{tabViewIndex:-1,currentVideoIndex:-1,scoreRuleLines:[],picList:[],picListNew:[],examIndex:0,examData:[],status:0,imgViewIndex:0,imgInfo:[],paperInfo:[],focusPointIndex:1,downloadBtnView:!1,WC_data:{iChannelID:"6",szStartTime:"2020-04-08 10:54:15",szEndTime:"2020-04-08 10:59:59"},WCVisable:!0}},mounted:function(){var e=JSON.parse(window.localStorage.getItem("adminUserData"));this.$store.commit("admin/SET_USERDATA",e),sessionStorage.getItem("mPIndex")?this.examIndex=sessionStorage.getItem("mPIndex"):sessionStorage.setItem("mPIndex",this.examIndex),this.getExamData()},methods:{setWndCover:function(b){this.WCVisable=!b},setTabViewIndex:function(e){if(this.tabViewIndex=e,0===e||3===e){this.setWndCover&&this.setWndCover(!1);var t=0===e?0:1;this.setWCData(t),this.WCL_Resize()}else this.setWndCover&&this.setWndCover(!0)},WCL_Resize:function(){var e=this;setTimeout((function(){e.$refs.webControlTest&&e.$refs.webControlTest.I_Resize&&e.$refs.webControlTest.I_Resize()}),100)},downloadVideoWebPlugin:function(){var e=this;this.$store.commit("admin/CHANGE_LOADING"),C()({url:"/api/teacher/download/haikangTemplate",method:"get",headers:{"Content-Type":"application/octet-stream"},responseType:"blob"}).then((function(t){d.a.downloadFile(t,"VideoWebPlugin.exe"),e.$store.commit("admin/CHANGE_LOADING")})).catch((function(t){e.$store.commit("admin/CHANGE_LOADING")}))},SRLkeydown:function(e,t){-1!==[37,38,39,40,13].indexOf(e.keyCode)&&(38===e.keyCode&&(this.focusPointIndex=this.focusPointIndex>1?this.focusPointIndex-1:1),40===e.keyCode&&(this.focusPointIndex=this.focusPointIndex<19?this.focusPointIndex+1:19),c()(".rule-point").eq(this.focusPointIndex-1).focus(),"0"!==this.examData.isMarked?(13===e.keyCode&&(t.markInfoLine.answerRight="0"===t.markInfoLine.answerRight?"1":"0"),37===e.keyCode&&(t.markInfoLine.answerRight="1"),39===e.keyCode&&(t.markInfoLine.answerRight="0"),this.updateScoreRuleLines(),e.preventDefault()):e.preventDefault())},updateScoreRuleLines:function(){var e=Object(o.a)(this.scoreRuleLines);this.scoreRuleLines=e},checkMarkPoint:function(){var e=this;this.setWndCover&&this.setWndCover(!0),this.imgInfo={show:!0,iSmall:!1,normal:!0,picList:[{url:"/api".concat(this.examData.markPoint)}],currentIndex:0,handlCancleEvent:function(){e.setWndCover&&e.setWndCover(!1)}}},handleClickImg:function(e,i,b){var t=this;this.tabViewIndex=1,this.setWndCover&&this.setWndCover(!0),this.imgInfo={show:!0,iSmall:b||!1,picList:this.picListNew,normal:!0,currentIndex:i,handlCancleEvent:function(){}},setTimeout((function(){t.$refs.authImgView&&t.$refs.authImgView.getSrcData&&t.$refs.authImgView.getSrcData()}),50)},checkVideo:function(e,t){var n=-1===t.indexOf("全景")?2:1,o=this.picListNew[e],r=new Date(new Date(o.time.replace(/\-/g,"/")).getTime()-3e4),c=new Date(new Date(o.time.replace(/\-/g,"/")).getTime()+3e4);n-=1;var l=d.a.dateFtt("yyyy-MM-dd hh:mm:ss",r),f=d.a.dateFtt("yyyy-MM-dd hh:mm:ss",c);this.tabViewIndex=-1,this.setWndCover&&this.setWndCover(!1),this.setWCData(n,l,f)},submitMark:function(){var e=this,t=[];this.scoreRuleLines.map((function(line){line.rules.map((function(e){t.push({ruleLineId:e.id,answerRight:e.markInfoLine.answerRight?e.markInfoLine.answerRight:""})}))}));var n=new FormData;n.append("examHeaderId",this.examData.examHeaderId),n.append("markLine",t),this.$store.dispatch("teacher/SUBMIT_MARK",{data:{examHeaderId:this.examData.examHeaderId,markLine:t},cb:function(t){t.succ&&(e.$message.success("评卷成功"),e.examData.isMarked="0",e.getNextExam())}})},getNextExam:function(){sessionStorage.setItem("mPIndex",++this.examIndex),this.getExamData()},setPicList:function(data){var e=this;this.picList={0:data.pic2?data.pic2:[],1:data.pic1?data.pic1:[]},this.picListNew=[];if(0!=this.picList[0].length){var t=this.paperList.filter((function(t){return t.id===e.paperInfo.id}))[0].mepImgType;for(var n in this.picListNew=[],t){var o=this.picList[t[n]][n];o&&this.picListNew.push({url:o.picUrl?o.picUrl:"http://experimentexam.oss-cn-beijing.aliyuncs.com/student/01.jpg",time:o.picStartTime})}console.log(this.picListNew)}},startCountDown:function(){0!==this.countDown.timeLimit&&(this.countDown.timeLimit-=1,this.countDown.timer=setTimeout(this.startCountDown,1e3))},setWCData:function(e,t,n){var o=this;this.currentVideoIndex=e;var video=this.videoList[e],data={iChannelID:video.channelNo.charAt(1),szStartTime:t||video.startTimeStampStr,szEndTime:n||video.endTimeStampStr};JSON.stringify(this.WC_data)!==JSON.stringify(data)&&(this.WC_data=data,setTimeout((function(){o.viewDoubleVideo()}),100))},initPlugin:function(){var e=this;this.tabViewIndex=0,setTimeout((function(){e.setWCData(0),e.WCL_Resize()}),1500)},viewDoubleVideo:function(){this.$refs.webControlTest&&this.$refs.webControlTest.preSPB_start&&this.$refs.webControlTest.preSPB_start()},getExamData:function(){var e=this,data=[],t="";sessionStorage.getItem("mPScheduleId")?(data={scheduleId:sessionStorage.getItem("mPScheduleId"),index:this.examIndex},t="teacher/GET_NEXT_EXAM",this.status=0):(data={examHeaderId:sessionStorage.getItem("mpExamHeaderId")},t="teacher/GET_STUDENT_EXAM",this.status=1),this.$store.dispatch(t,{data:data,cb:function(t){if(t.succ){for(var n in e.examData=t.data?t.data:[],e.paperInfo.id=e.examData.paperId?e.examData.paperId:1,e.paperInfo.answer=[],e.examData.examLines&&e.examData.examLines.map((function(t){e.paperInfo.answer.push(t.remark?t.remark:"")})),e.videoList=[],t.data.video)e.videoList.push(t.data.video[n]);e.videoList.reverse(),e.scoreRuleLines=t.data.scoreRuleLines?t.data.scoreRuleLines:[],e.scoreRuleLines=e.scoreRuleLines.map((function(e){return e.rules=e.rules.map((function(e){return e.markInfoLine||(e.markInfoLine={answerRight:"0"}),e})),e})),e.setPicList(t.data),e.selectedVideoIndex=3;setTimeout((function(){0===e.videoList.length?e.viewPaper():e.initPlugin()}),500);"0"!==e.examData.isMarked&&(e.countDown.timeLimit=10,e.startCountDown())}else sessionStorage.setItem("mPIndex",--e.examIndex)}})}},computed:{ruleLineWidth:function(){return.4*(this.DcSize.width-20)-40-20+"px"},markCompleted:function(){var e=!0;return this.scoreRuleLines.map((function(line){line.rules.map((function(t){e=e&&t.markInfoLine.answerRight}))})),e},totalScore:function(){var e=0;return this.scoreRuleLines.map((function(line){line.rules.map((function(t){e+=parseFloat(t.reqNum)}))})),e},score:function(){var e=0;return this.scoreRuleLines.map((function(line){line.rules.map((function(t){e+="0"===t.markInfoLine.answerRight?parseFloat(t.reqNum):0}))})),e}},head:function(){return{title:"实验考试评卷系统",script:[{src:"../../../jsWebControl-1.0.0.min.js"},{src:"../../../jsencrypt.min.js"}]}}},k=(n(640),n(10)),component=Object(k.a)(_,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.$store.state.admin.loading,expression:"$store.state.admin.loading"}],staticStyle:{position:"relative"},style:{height:e.DcSize.height+"px"}},[n("div",{staticClass:"top-userInfo"},[n("strong",[e._v("中学科学实验教考管理系统")]),e._v("\n    您好，"+e._s(e.$store.state.admin.adminUserData.userName)+"！\n    "),n("div",{staticClass:"button",on:{click:function(t){return e.confrimLogout()}}},[n("i",{staticClass:"iconfont icon-power"}),e._v(" 退出")])]),e._v(" "),n("div",{staticClass:"container"},[n("div",{staticClass:"box"},[n("div",{staticClass:"box-head"},[e._v("\n        网上阅卷\n        "),n("div",{staticClass:"camera-list"},[n("span",{class:{selected:0===e.tabViewIndex},on:{click:function(t){return e.setTabViewIndex(0)}}},[n("i",{staticClass:"el-icon-video-camera"}),e._v("\n            近景录像\n          ")]),e._v(" "),n("span",{class:{selected:3===e.tabViewIndex},on:{click:function(t){return e.setTabViewIndex(3)}}},[n("i",{staticClass:"el-icon-video-camera"}),e._v("\n            全景录像\n          ")]),e._v(" "),n("span",{class:{selected:1===e.tabViewIndex},on:{click:function(t){return e.setTabViewIndex(1)}}},[n("i",{staticClass:"el-icon-picture-outline"}),e._v("\n            考查得分图片\n          ")]),e._v(" "),n("span",{class:{selected:2===e.tabViewIndex},on:{click:function(t){return e.setTabViewIndex(2)}}},[n("i",{staticClass:"el-icon-document"}),e._v("\n            查看试卷\n          ")])])]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.WCVisable&&2!==e.tabViewIndex&&1!==e.tabViewIndex,expression:"WCVisable && tabViewIndex !== 2 && tabViewIndex !== 1"}],staticClass:"box-body",staticStyle:{overflow:"auto"}},[n("web-control",{ref:"webControlTest",attrs:{WCdata:e.WC_data}})],1),e._v(" "),2===e.tabViewIndex?n("div",{staticClass:"box-body",staticStyle:{overflow:"auto"}},[n(e.paperList.filter((function(t){return t.id===e.paperInfo.id}))[0].com,{tag:"component",attrs:{paperInfo:e.paperInfo}})],1):e._e(),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:1===e.tabViewIndex,expression:"tabViewIndex === 1"}],staticClass:"box-body",staticStyle:{overflow:"auto"}},[n("img-list-view",{attrs:{picList:e.picListNew,handleClickImg:e.handleClickImg}}),e._v(" "),e.imgInfo.show&&e.imgInfo.iSmall?n("auth-img-view",{ref:"authImgView",attrs:{imgInfo:e.imgInfo}}):e._e()],1)]),e._v(" "),n("div",{staticClass:"box"},[n("div",{staticClass:"box-head"},[e._v("\n        评分标准\n        "),n("a",{attrs:{href:"javascript:void()"},on:{click:function(t){return e.checkMarkPoint()}}},[e._v("评分要点>")])]),e._v(" "),n("div",{staticClass:"box-body"},[e._m(0),e._v(" "),n("div",{staticClass:"score-rule-lines"},e._l(e.scoreRuleLines,(function(line,i){return n("div",{key:i,staticClass:"rule-line"},[n("strong",[e._v(e._s(i+1)+". "+e._s(line.title))]),e._v(" "),e._l(line.rules,(function(t,o){return n("div",{key:t.checkNum,staticClass:"rule-point ",attrs:{tabindex:"0"},on:{keydown:function(n){return e.SRLkeydown(n,t)},click:function(n){e.focusPointIndex=parseInt(t.checkNum)}}},[n("div",[e._v("\n                ("+e._s(t.checkNum)+") "+e._s(t.checkRemark)+"\n                "),!t.picNum||t.videoType&&-1!==t.videoType.indexOf("ONLY")?e._e():n("i",{staticClass:"el-icon-picture-outline icon",attrs:{title:"查看图片"},on:{click:function(n){return e.handleClickImg(n,t.picNum-1,!0)}}}),e._v(" "),t.videoType?n("i",{staticClass:"el-icon-video-camera icon",attrs:{title:"查看视频"},on:{click:function(n){return e.checkVideo(t.picNum-1,t.videoType)}}}):e._e(),e._v(" "),(t.examLine,e._e())]),e._v(" "),n("div",{staticStyle:{width:"80px","text-align":"center"}},[n("el-switch",{attrs:{"inactive-color":"#ff4949","active-value":"0","inactive-value":"1",width:25,disabled:"0"===e.examData.isMarked},on:{change:e.updateScoreRuleLines},model:{value:t.markInfoLine.answerRight,callback:function(n){e.$set(t.markInfoLine,"answerRight",n)},expression:"point.markInfoLine.answerRight"}})],1)])}))],2)})),0),e._v(" "),e.scoreRuleLines.length>0?n("div",{staticClass:"score-total"},[n("span",[e._v("总分:"+e._s(e.totalScore)+"分")]),e._v(" "),n("span",[e._v("得分:"),n("strong",[e._v(e._s(e.score)+"分")])]),e._v(" "),n("div",{staticClass:"operation"},["1"===e.examData.isMarked?n("el-button",{attrs:{type:e.markCompleted?"primary":"info",disabled:!e.markCompleted||0!=e.countDown.timeLimit},on:{click:e.submitMark}},[e._v("\n              "+e._s(e.markCompleted?0!=e.countDown.timeLimit?e.countDown.timeLimit:"完成评卷":"未完成评卷")+"\n            ")]):e._e(),e._v(" "),"0"===e.examData.isMarked?n("el-button",{attrs:{type:"primary",disabled:""}},[e._v("\n              已完成评卷\n            ")]):e._e(),e._v(" "),0===e.status?n("el-button",{on:{click:e.getNextExam}},[e._v("跳过>>")]):e._e()],1)]):e._e()])])]),e._v(" "),n("el-confrim",{attrs:{confrimInfo:e.confrimInfo}}),e._v(" "),e.imgInfo.show&&!e.imgInfo.iSmall?n("auth-img-view",{attrs:{imgInfo:e.imgInfo}}):e._e()],1)}),[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"point-top"},[n("span",[e._v("得分")])])}],!1,null,"13defdef",null);t.default=component.exports}}]);